<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agar.io AI</title>
    <link rel="stylesheet" href="https://pyscript.net/releases/2024.1.1/core.css" />
    <link rel="stylesheet" href="style.css">
    <script type="module" src="https://pyscript.net/releases/2024.1.1/core.js"></script>
</head>
<body>
    <div class="container">
        <div class="game-window">
            <div id="pygame-app">
                <div id="loading-overlay">
                    <div class="loading-text">....................</div>
                    <div class="spinner"></div>
                    <div class="loading-subtext">This may take a moment.</div>
                </div>
            </div>
        </div>
        <div class="controls">
            <h1>Game Settings</h1>
            <div class="control-group">
                <label for="cpu-opponents">CPU Opponents</label>
                <select id="cpu-opponents">
                    <option value="5">5</option>
                    <option value="10" selected>10</option>
                    <option value="15">15</option>
                    <option value="20">20</option>
                </select>
            </div>
            <div class="control-group">
                <label>AI Opponents</label>
                <div class="ai-opponents-selection">
                    <div class="ai-opponent">
                        <label for="ai-aggressor">Aggressor</label>
                        <input type="number" id="ai-aggressor" value="1" min="0" max="5">
                    </div>
                    <div class="ai-opponent">
                        <label for="ai-farmer">Farmer</label>
                        <input type="number" id="ai-farmer" value="1" min="0" max="5">
                    </div>
                    <div class="ai-opponent">
                        <label for="ai-survivor">Survivor</label>
                        <input type="number" id="ai-survivor" value="1" min="0" max="5">
                    </div>
                </div>
                <button id="shuffle-ai">Shuffle AI</button>
            </div>
            <div class="control-group">
                <label for="food-slider">Food</label>
                <input type="range" id="food-slider" min="200" max="1500" value="850">
                <span id="food-value">850</span>
            </div>
            <div class="control-group">
                <label for="virus-slider">Viruses</label>
                <input type="range" id="virus-slider" min="5" max="30" value="14">
                <span id="virus-value">14</span>
            </div>
            <button id="reset-game">Reset Game</button>
        </div>
    </div>
    
    <!-- PyScript Configuration -->
    <py-config>
        # torch is GONE, onnxruntime-web is ADDED.
        packages = [
          "pygame-ce",
          "numpy",
          "pillow",
          "onnxruntime-web"
        ]
        # We fetch the small .onnx files instead of the big .zip files
        [[fetch]]
        files = [
          "./game/main.py",
          "./game/aggressor.onnx",
          "./game/farmer.onnx",
          "./game/survivor.onnx"
        ]
    </py-config>

    <py-script src="./game/main.py"></py-script>

    <script src="script.js"></script>
</body>
</html>
